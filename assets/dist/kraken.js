!function(){"use strict";const e=window.jQuery;function t(n,a,i,s,o){const r=n.parents(".kraken-bulk-optimizer").find(".kraken-bulk-table tbody"),c=a.shift(),k=n.find(".spinner");if(void 0===c)return o<s?function(n,a,i,s){e.ajax({type:"POST",url:window.kraken_options.ajax_url,data:{action:"kraken_get_bulk_pages",paged:s,nonce:window.kraken_options.nonce},success(e){const o=e.data;o.ids.length>0&&t(n,o.ids,a,i,s)},error(){}})}(n,i,s,o+=1):k.removeClass("is-active"),!1;i+=1,e.ajax({type:"POST",url:window.kraken_options.ajax_url,data:{action:"kraken_optimize_image",id:c,type:"bulk",nonce:window.kraken_options.nonce},success(c){c.success&&r.append(e(c.data.html)),e(".optimized").text(i),t(n,a,i,s,o)},error(){e(".optimized").text(i),t(n,a,i,s,o)}})}e(document).on("click",".kraken-stats-action-show-details",(function(t){t.preventDefault(),e(this).next().toggleClass("is-visible")})),e(document).on("click",".kraken-stats-action-popup-close",(function(t){t.preventDefault(),e(this).parent().removeClass("is-visible")})),e(document).on("click",".kraken-stats-action-reset-image",(function(t){if(t.preventDefault(),!confirm(window.kraken_options.texts.reset_image))return;const n=e(this),a=n.data("id");n.find(".spinner").addClass("is-active"),e.ajax({type:"POST",url:window.kraken_options.ajax_url,data:{action:"kraken_reset_image",id:a,nonce:window.kraken_options.nonce},success(e){e.success?n.parents(".kraken-stats-media-column").replaceWith(e.data.html):alert(window.kraken_options.texts.error_reset)},error(){alert(window.kraken_options.texts.error_reset)}})})),e(document).on("click",".kraken-button-optimize-image",(function(t){t.preventDefault();const n=e(this),a=n.find(".spinner"),i=n.data("id");a.addClass("is-active"),e.ajax({type:"POST",url:window.kraken_options.ajax_url,data:{action:"kraken_optimize_image",id:i,type:"single",nonce:window.kraken_options.nonce},success(e){e.success?n.parents(".kraken-stats-media-column").replaceWith(e.data.html):(alert(window.kraken_options.texts.error_reset),a.removeClass("is-active"))},error(){alert(window.kraken_options.texts.error_reset),a.removeClass("is-active")}})})),e(document).on("click",".kraken-button-bulk-optimize",(function(n){n.preventDefault();const a=e(this),i=a.find(".spinner"),s=a.data("pages"),o=a.data("ids");a.parents(".kraken-bulk-actions").addClass("is-active"),i.addClass("is-active"),t(a,o,0,s,1)})),e(document).on("click",".kraken-bulk-close-modal",(function(t){t.preventDefault(),e(this).parents(".kraken-modal").removeClass("is-active")})),function(e,t){if(0===e.length)return!1;const n=e.find("canvas")[0].getContext("2d"),a=Math.PI/180,i=e.data("percent"),s=e.data("color"),o=3.6*i;n.strokeStyle=s,n.lineWidth=10,n.clearRect(0,0,t,t),n.beginPath(),n.arc(60,60,55,270*a,a*(270+o)),n.stroke()}(e(".kraken-progress-circle"),120)}();