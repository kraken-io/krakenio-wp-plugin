!function(){"use strict";const e=window.jQuery;function t(n,a,i,o,s){const r=a.shift(),c=n.find(".spinner");if(void 0===r)return s<o?function(n,a,i,o){e.ajax({type:"POST",url:window.kraken_options.ajax_url,data:{action:"kraken_get_bulk_pages",paged:o,nonce:window.kraken_options.nonce},success(e){const s=e.data;s.ids.length>0&&t(n,s.ids,a,i,o)},error(){}})}(n,i,o,s+=1):c.removeClass("is-active"),!1;i+=1;const d=n.parents(".kraken-bulk-optimizer").find(".kraken-bulk-table tbody");e.ajax({type:"POST",url:window.kraken_options.ajax_url,data:{action:"kraken_optimize_image",id:r,type:"bulk",nonce:window.kraken_options.nonce},success(r){r.success&&d.append(e(r.data.html)),e(".optimized").text(i),t(n,a,i,o,s)},error(){e(".optimized").text(i),t(n,a,i,o,s)}})}e(document).on("click",".kraken-stats-action-show-details",(function(t){t.preventDefault(),e(this).next().toggleClass("is-visible")})),e(document).on("click",".kraken-stats-action-reset-image",(function(t){if(t.preventDefault(),!window.confirm(window.kraken_options.texts.reset_image))return;const n=e(this),a=n.data("id");n.find(".spinner").addClass("is-active"),e.ajax({type:"POST",url:window.kraken_options.ajax_url,data:{action:"kraken_reset_image",id:a,nonce:window.kraken_options.nonce},success(e){e.success?n.parents(".kraken-stats-media-column").replaceWith(e.data.html):window.alert(window.kraken_options.texts.error_reset)},error(){window.alert(window.kraken_options.texts.error_reset)}})})),e(document).on("click",".kraken-button-optimize-image",(function(t){t.preventDefault();const n=e(this),a=n.find(".spinner"),i=n.data("id");a.addClass("is-active"),e.ajax({type:"POST",url:window.kraken_options.ajax_url,data:{action:"kraken_optimize_image",id:i,type:"single",nonce:window.kraken_options.nonce},success(e){e.success?n.parents(".kraken-stats-media-column").replaceWith(e.data.html):(window.alert(window.kraken_options.texts.error_reset),a.removeClass("is-active"))},error(){window.alert(window.kraken_options.texts.error_reset),a.removeClass("is-active")}})})),e(document).on("click",".kraken-button-bulk-optimize",(function(n){n.preventDefault();const a=e(this),i=a.find(".spinner"),o=a.data("pages"),s=a.data("ids");a.parents(".kraken-bulk-actions").addClass("is-active"),i.addClass("is-active"),t(a,s,0,o,1)})),e(document).on("click",".kraken-bulk-close-modal",(function(t){t.preventDefault(),e(this).parents(".kraken-modal").removeClass("is-active")})),function(e,t){if(0===e.length)return!1;const n=e.find("canvas")[0].getContext("2d"),a=Math.PI/180,i=e.data("percent"),o=e.data("color"),s=3.6*i;n.strokeStyle=o,n.lineWidth=10,n.clearRect(0,0,t,t),n.beginPath(),n.arc(60,60,55,270*a,a*(270+s)),n.stroke()}(e(".kraken-progress-circle"),120)}();